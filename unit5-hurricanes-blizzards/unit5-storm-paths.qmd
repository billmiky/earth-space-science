---
title: "Unit 5: Paths of Severe Storms 5E"
subtitle: "Why do storms follow the paths they do, and could those paths shift?"
author: "Earth & Space Science"
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    theme: cosmo
    code-fold: true
    self-contained: true
execute:
  echo: true
  warning: false
---

```{=html}
<style>
@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@700&family=Inter:wght@400;600;800&display=swap');

.engage-box { 
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
  color: white;
  padding: 25px; 
  margin: 20px 0; 
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
  border: none;
}
.engage-box h2 { font-family: 'Space Grotesk', sans-serif; font-size: 2em; margin-top: 0; }

.explore-box { 
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); 
  color: white;
  padding: 25px; 
  margin: 20px 0; 
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(240, 147, 251, 0.3);
}

.explain-box { 
  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); 
  color: #1a1a1a;
  padding: 25px; 
  margin: 20px 0; 
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(79, 172, 254, 0.3);
}

.elaborate-box { 
  background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); 
  color: #1a1a1a;
  padding: 25px; 
  margin: 20px 0; 
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(67, 233, 123, 0.3);
}

.evaluate-box { 
  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); 
  color: #1a1a1a;
  padding: 25px; 
  margin: 20px 0; 
  border-radius: 15px;
  box-shadow: 0 10px 30px rgba(250, 112, 154, 0.3);
}

.check-understanding { 
  background: linear-gradient(to right, #667eea, #764ba2);
  color: white;
  padding: 20px; 
  margin: 20px 0;
  border-radius: 12px;
  border-left: 6px solid #fff;
}

.key-idea { 
  background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
  padding: 20px; 
  margin: 20px 0;
  border-radius: 12px;
  border-left: 8px solid #ff6b6b;
  font-size: 1.1em;
}

.lab-activity { 
  background: linear-gradient(to bottom, #ffeaa7, #fdcb6e);
  border: 4px solid #e17055; 
  padding: 25px; 
  margin: 25px 0; 
  border-radius: 15px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}

.quiz-section { 
  background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
  padding: 25px; 
  margin: 25px 0; 
  border-radius: 15px;
  border: 4px dashed #ff6b6b;
}

.pe-badge { 
  display: inline-block; 
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white; 
  padding: 8px 16px; 
  border-radius: 20px; 
  font-size: 13px; 
  font-weight: 800;
  margin: 5px;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
  text-transform: uppercase;
  letter-spacing: 1px;
}

.big-question {
  font-family: 'Space Grotesk', sans-serif;
  font-size: 2.5em;
  font-weight: 800;
  background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin: 30px 0 20px 0;
  text-align: center;
  animation: slideIn 0.8s ease-out;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateY(-20px); }
  to { opacity: 1; transform: translateY(0); }
}

.mind-blown {
  background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
  color: white;
  padding: 20px;
  margin: 20px 0;
  border-radius: 15px;
  font-size: 1.3em;
  font-weight: 700;
  text-align: center;
  box-shadow: 0 10px 25px rgba(39, 174, 96, 0.4);
}

.student-task {
  background: #fff3e0;
  border-left: 5px solid #ff9800;
  padding: 20px;
  margin: 15px 0;
  border-radius: 0 10px 10px 0;
}

h1 { 
  font-family: 'Space Grotesk', sans-serif !important;
  font-weight: 800 !important;
  font-size: 2.8em !important;
  margin-top: 40px !important;
}

h2 { 
  font-family: 'Space Grotesk', sans-serif !important;
  font-weight: 700 !important;
  color: #27ae60 !important;
}
</style>
```

<span class="pe-badge">HS-ESS2-8</span> <span class="pe-badge">Time: 6‚Äì11 Days</span>

<div class="big-question">üó∫Ô∏è Why Do Storms Follow the Paths They Do? üó∫Ô∏è</div>

# Engage: The Investigative Phenomenon

::: {.engage-box}
## üåç Storm Tracks: 2018‚Äì2020

<div style="font-size: 1.3em; font-weight: 700; text-align: center; margin: 20px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
Maps from 2018‚Äì2020 show that blizzards and hurricanes exhibit clear patterns in where they start and the direction they travel.
</div>

### ü§î Key Observations:
- üåÄ Hurricanes form over **warm tropical oceans** and move **westward, then curve northeast**
- üå®Ô∏è Blizzards track along the **East Coast**, moving from **southwest to northeast**
- üó∫Ô∏è Neither storm type occurs **randomly** ‚Äî they follow **predictable pathways**

**Driving Question:** Why do severe storms follow specific paths, and what could cause those paths to change?
:::

::: {.student-task}
### üìù Pattern Spotting

Look at the storm track maps below. Before we explain the science, write down:

1. What **geographic patterns** do you notice in storm tracks?
2. What **direction** do most storms move in the mid-latitudes?
3. Why do you think hurricanes start near the equator but blizzards start in the mid-latitudes?
:::

# Explore: Mapping Storm Trajectories

::: {.explore-box}
## üî¨ Investigation: Where Do Storms Go?

Let's visualize real storm trajectory patterns and look for the underlying cause of these paths.
:::

```{ojs}
//| echo: false
Plot = require("@observablehq/plot")
d3 = require("d3@7")
```

```{ojs}
//| echo: false
viewof stormTypeMap = Inputs.radio(
  ["Atlantic Hurricanes", "Northeast Blizzards", "Both"],
  {label: "Show storm tracks:", value: "Both"}
)
```

```{ojs}
//| echo: false
{
  const width = 750;
  const height = 450;
  const svg = d3.create("svg").attr("width", width).attr("height", height).attr("viewBox", `0 0 ${width} ${height}`);

  // Ocean background
  svg.append("rect").attr("width", width).attr("height", height).attr("fill", "#e3f2fd").attr("rx", 10);

  // Simplified North America outline
  svg.append("path")
    .attr("d", "M 100,80 L 150,60 L 200,70 L 280,80 L 320,100 L 350,120 L 380,150 L 360,180 L 370,220 L 390,250 L 380,280 L 360,320 L 340,350 L 300,370 L 250,380 L 200,370 L 160,340 L 140,300 L 120,250 L 100,200 L 90,150 Z")
    .attr("fill", "#a5d6a7").attr("stroke", "#4caf50").attr("stroke-width", 2);

  // Labels
  svg.append("text").attr("x", 230).attr("y", 230).attr("font-size", 13).attr("fill", "#2e7d32").attr("font-weight", "bold").text("USA");
  svg.append("text").attr("x", 550).attr("y", 100).attr("font-size", 11).attr("fill", "#1565c0").text("Atlantic Ocean");
  svg.append("text").attr("x", 450).attr("y", 380).attr("font-size", 11).attr("fill", "#1565c0").text("Caribbean Sea");
  svg.append("text").attr("x", 200).attr("y", 420).attr("font-size", 11).attr("fill", "#1565c0").text("Gulf of Mexico");

  // Latitude lines
  [100, 180, 260, 340].forEach((y, i) => {
    svg.append("line").attr("x1", 0).attr("y1", y).attr("x2", 750).attr("y2", y)
      .attr("stroke", "#90caf9").attr("stroke-width", 0.5).attr("stroke-dasharray", "3,3");
    svg.append("text").attr("x", 720).attr("y", y - 3).attr("font-size", 9).attr("fill", "#64b5f6")
      .text(`${60 - i * 15}¬∞N`);
  });

  // NYC marker
  svg.append("circle").attr("cx", 380).attr("cy", 160).attr("r", 6).attr("fill", "#f44336");
  svg.append("text").attr("x", 390).attr("y", 155).attr("font-size", 11).attr("font-weight", "bold").attr("fill", "#f44336").text("NYC");

  if (stormTypeMap === "Atlantic Hurricanes" || stormTypeMap === "Both") {
    // Hurricane tracks (typical recurvature pattern)
    const hurricaneTracks = [
      [{x: 650, y: 360}, {x: 580, y: 340}, {x: 500, y: 330}, {x: 430, y: 310}, {x: 400, y: 280}, {x: 420, y: 240}, {x: 470, y: 200}, {x: 540, y: 160}],
      [{x: 700, y: 380}, {x: 620, y: 370}, {x: 540, y: 360}, {x: 460, y: 340}, {x: 380, y: 320}, {x: 340, y: 290}, {x: 350, y: 250}, {x: 380, y: 210}],
      [{x: 680, y: 400}, {x: 600, y: 390}, {x: 520, y: 380}, {x: 440, y: 370}, {x: 360, y: 350}, {x: 300, y: 330}, {x: 280, y: 300}]
    ];

    const colors = ["#e74c3c", "#c0392b", "#e67e22"];
    hurricaneTracks.forEach((track, i) => {
      svg.append("path")
        .attr("d", d3.line().x(d => d.x).y(d => d.y).curve(d3.curveCatmullRom)(track))
        .attr("stroke", colors[i]).attr("stroke-width", 3).attr("fill", "none")
        .attr("stroke-dasharray", "8,3");
      // Start marker
      svg.append("circle").attr("cx", track[0].x).attr("cy", track[0].y).attr("r", 5).attr("fill", colors[i]);
      // End marker
      svg.append("text").attr("x", track[track.length-1].x).attr("y", track[track.length-1].y).attr("font-size", 16).text("üåÄ");
    });

    svg.append("rect").attr("x", 520).attr("y", 130).attr("width", 180).attr("height", 30).attr("fill", "#ffebee").attr("rx", 5);
    svg.append("text").attr("x", 530).attr("y", 150).attr("font-size", 12).attr("fill", "#c62828").text("üåÄ Hurricane Tracks");
  }

  if (stormTypeMap === "Northeast Blizzards" || stormTypeMap === "Both") {
    // Blizzard tracks (Nor'easters tracking up the coast)
    const blizzardTracks = [
      [{x: 280, y: 320}, {x: 320, y: 280}, {x: 360, y: 230}, {x: 400, y: 180}, {x: 440, y: 130}, {x: 500, y: 90}],
      [{x: 260, y: 340}, {x: 300, y: 300}, {x: 340, y: 250}, {x: 380, y: 200}, {x: 420, y: 150}, {x: 470, y: 110}],
      [{x: 300, y: 350}, {x: 340, y: 310}, {x: 370, y: 260}, {x: 400, y: 210}, {x: 440, y: 160}, {x: 490, y: 120}]
    ];

    const bcolors = ["#3498db", "#2980b9", "#1abc9c"];
    blizzardTracks.forEach((track, i) => {
      svg.append("path")
        .attr("d", d3.line().x(d => d.x).y(d => d.y).curve(d3.curveCatmullRom)(track))
        .attr("stroke", bcolors[i]).attr("stroke-width", 3).attr("fill", "none");
      svg.append("circle").attr("cx", track[0].x).attr("cy", track[0].y).attr("r", 5).attr("fill", bcolors[i]);
      svg.append("text").attr("x", track[track.length-1].x).attr("y", track[track.length-1].y).attr("font-size", 16).text("üå®Ô∏è");
    });

    svg.append("rect").attr("x", 520).attr("y", 170).attr("width", 180).attr("height", 30).attr("fill", "#e3f2fd").attr("rx", 5);
    svg.append("text").attr("x", 530).attr("y", 190).attr("font-size", 12).attr("fill", "#1565c0").text("üå®Ô∏è Blizzard Tracks");
  }

  // Direction annotation
  svg.append("rect").attr("x", 50).attr("y", 400).attr("width", 400).attr("height", 35).attr("fill", "white").attr("opacity", 0.8).attr("rx", 5);
  svg.append("text").attr("x", 250).attr("y", 422).attr("text-anchor", "middle").attr("font-size", 13).attr("font-weight", "bold")
    .text("Both storm types generally move from SW ‚Üí NE in the mid-latitudes");

  return svg.node();
}
```

::: {.key-idea}
### üí° Key Observation

Despite forming in very different locations and for very different reasons, both hurricanes (once they curve north) and blizzards travel in the **same general direction**: from **southwest to northeast** across the mid-latitudes.

This is NOT a coincidence. Something is **steering** these storms.
:::

# Explain: The Global Wind Engine

::: {.explain-box}
## üå¨Ô∏è Why Does the Wind Blow the Way It Does?

To understand storm paths, we need to understand the global circulation of the atmosphere ‚Äî the "engine" that steers weather systems around the planet.
:::

## Uneven Solar Heating: The Root Cause

The Sun doesn't heat Earth evenly. The equator receives far more solar energy per unit area than the poles because of the angle at which sunlight hits the surface.

```{ojs}
//| echo: false
{
  const width = 750;
  const height = 380;
  const svg = d3.create("svg").attr("width", width).attr("height", height).attr("viewBox", `0 0 ${width} ${height}`);

  svg.append("rect").attr("width", width).attr("height", height).attr("fill", "#1a1a2e").attr("rx", 10);

  // Earth (circle)
  const cx = 375, cy = 200, r = 140;
  svg.append("circle").attr("cx", cx).attr("cy", cy).attr("r", r).attr("fill", "#2980b9");

  // Latitude bands
  const bands = [
    {y1: -1, y2: -0.5, label: "60-90¬∞N", color: "#74b9ff", energy: "Low"},
    {y1: -0.5, y2: 0, label: "30-60¬∞N", color: "#a29bfe", energy: "Medium"},
    {y1: 0, y2: 0.5, label: "0-30¬∞N", color: "#fdcb6e", energy: "High"},
    {y1: 0.5, y2: 1, label: "0-30¬∞S", color: "#fdcb6e", energy: "High"}
  ];

  bands.forEach(b => {
    const y1 = cy - b.y1 * r;
    const y2 = cy - b.y2 * r;
    const x1 = cx - Math.sqrt(r*r - (cy-y1)*(cy-y1)) || cx;
    const x2 = cx + Math.sqrt(r*r - (cy-y1)*(cy-y1)) || cx;
    svg.append("line").attr("x1", x1).attr("y1", y1).attr("x2", x2).attr("y2", y1)
      .attr("stroke", b.color).attr("stroke-width", 1).attr("stroke-dasharray", "3,3");
  });

  // Sun rays
  const sunX = 100;
  const rays = [
    {y: cy - 100, angle: 30, label: "Spread out ‚Üí less energy/area", color: "#74b9ff"},
    {y: cy, angle: 0, label: "Direct ‚Üí maximum energy/area", color: "#f39c12"},
    {y: cy + 80, angle: -20, label: "Spread out ‚Üí less energy/area", color: "#74b9ff"}
  ];

  svg.append("circle").attr("cx", 50).attr("cy", cy).attr("r", 30).attr("fill", "#f39c12");
  svg.append("text").attr("x", 50).attr("y", cy + 5).attr("text-anchor", "middle").attr("font-size", 20).text("‚òÄÔ∏è");

  rays.forEach(ray => {
    svg.append("line").attr("x1", 90).attr("y1", ray.y).attr("x2", cx - r + 20).attr("y2", ray.y + Math.tan(ray.angle * Math.PI/180) * 200)
      .attr("stroke", ray.color).attr("stroke-width", 2);
    svg.append("text").attr("x", cx + r + 20).attr("y", ray.y + 5).attr("font-size", 11).attr("fill", ray.color).text(ray.label);
  });

  // Energy bar chart on right
  const barData = [{lat: "Equator", energy: 100}, {lat: "30¬∞", energy: 75}, {lat: "60¬∞", energy: 40}, {lat: "90¬∞", energy: 15}];
  const barX = 620;
  barData.forEach((d, i) => {
    const barW = d.energy * 0.8;
    const barY = 100 + i * 55;
    svg.append("rect").attr("x", barX).attr("y", barY).attr("width", barW).attr("height", 30)
      .attr("fill", d.energy > 60 ? "#f39c12" : "#74b9ff").attr("rx", 4);
    svg.append("text").attr("x", barX - 5).attr("y", barY + 20).attr("text-anchor", "end").attr("font-size", 11).attr("fill", "white").text(d.lat);
    svg.append("text").attr("x", barX + barW + 5).attr("y", barY + 20).attr("font-size", 10).attr("fill", "#dfe6e9").text(`${d.energy}%`);
  });

  svg.append("text").attr("x", 375).attr("y", 370).attr("text-anchor", "middle").attr("font-size", 14).attr("fill", "#dfe6e9").attr("font-weight", "bold")
    .text("Uneven heating creates a temperature gradient from equator to poles ‚Üí drives atmospheric circulation");

  return svg.node();
}
```

## Convection Cells: Nature's Heat Redistributors

This uneven heating drives enormous **convection cells** in the atmosphere ‚Äî rising warm air near the equator and sinking cool air at higher latitudes.

```{ojs}
//| echo: false
{
  const width = 750;
  const height = 500;
  const svg = d3.create("svg").attr("width", width).attr("height", height).attr("viewBox", `0 0 ${width} ${height}`);

  svg.append("rect").attr("width", width).attr("height", height).attr("fill", "#f0f4ff").attr("rx", 10);
  svg.append("text").attr("x", 375).attr("y", 30).attr("text-anchor", "middle").attr("font-size", 20).attr("font-weight", "bold").text("Global Atmospheric Circulation Cells");

  // Earth surface line
  svg.append("line").attr("x1", 50).attr("y1", 400).attr("x2", 700).attr("y2", 400).attr("stroke", "#2d3436").attr("stroke-width", 3);

  // Latitude labels
  const lats = [{x: 50, label: "90¬∞N"}, {x: 158, label: "60¬∞N"}, {x: 267, label: "30¬∞N"}, {x: 375, label: "0¬∞ (Equator)"}, {x: 483, label: "30¬∞S"}, {x: 592, label: "60¬∞S"}, {x: 700, label: "90¬∞S"}];
  lats.forEach(l => {
    svg.append("line").attr("x1", l.x).attr("y1", 395).attr("x2", l.x).attr("y2", 405).attr("stroke", "#2d3436").attr("stroke-width", 2);
    svg.append("text").attr("x", l.x).attr("y", 420).attr("text-anchor", "middle").attr("font-size", 11).text(l.label);
  });

  // Hadley Cells (equator to 30¬∞)
  const drawCell = (x1, x2, y1, y2, color, name, direction) => {
    svg.append("rect").attr("x", Math.min(x1,x2)).attr("y", y2).attr("width", Math.abs(x2-x1)).attr("height", y1-y2)
      .attr("fill", color).attr("opacity", 0.15).attr("rx", 5);
    // Circulation arrows
    const midX = (x1+x2)/2;
    const midY = (y1+y2)/2;
    if (direction === "cw") {
      svg.append("path").attr("d", `M ${x1+10},${y1-10} L ${x1+10},${y2+10} L ${x2-10},${y2+10} L ${x2-10},${y1-10}`)
        .attr("stroke", color).attr("stroke-width", 2.5).attr("fill", "none").attr("marker-end", `url(#arrow-${name})`);
    } else {
      svg.append("path").attr("d", `M ${x2-10},${y1-10} L ${x2-10},${y2+10} L ${x1+10},${y2+10} L ${x1+10},${y1-10}`)
        .attr("stroke", color).attr("stroke-width", 2.5).attr("fill", "none").attr("marker-end", `url(#arrow-${name})`);
    }
    svg.append("text").attr("x", midX).attr("y", midY).attr("text-anchor", "middle").attr("font-size", 13).attr("font-weight", "bold").attr("fill", color).text(name);

    const defs = svg.select("defs").empty() ? svg.append("defs") : svg.select("defs");
    defs.append("marker").attr("id", `arrow-${name}`).attr("viewBox", "0 0 10 10").attr("refX", 5).attr("refY", 5)
      .attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto-start-reverse")
      .append("path").attr("d", "M 0 0 L 10 5 L 0 10 z").attr("fill", color);
  };

  // Polar Cell (90-60¬∞N)
  drawCell(50, 158, 390, 200, "#3498db", "Polar", "cw");
  // Ferrel Cell (60-30¬∞N)
  drawCell(158, 267, 390, 150, "#9b59b6", "Ferrel", "ccw");
  // Hadley Cell (30-0¬∞N)
  drawCell(267, 375, 390, 100, "#e74c3c", "Hadley", "cw");
  // Hadley Cell (0-30¬∞S)
  drawCell(375, 483, 390, 100, "#e74c3c", "Hadley", "ccw");
  // Ferrel Cell (30-60¬∞S)
  drawCell(483, 592, 390, 150, "#9b59b6", "Ferrel", "cw");
  // Polar Cell (60-90¬∞S)
  drawCell(592, 700, 390, 200, "#3498db", "Polar", "ccw");

  // Surface wind labels
  const winds = [
    {x: 104, y: 440, text: "Polar Easterlies", arrow: "‚Üê"},
    {x: 212, y: 440, text: "Westerlies", arrow: "‚Üí"},
    {x: 321, y: 440, text: "Trade Winds (NE)", arrow: "‚Üê"},
    {x: 429, y: 440, text: "Trade Winds (SE)", arrow: "‚Üí"},
    {x: 537, y: 440, text: "Westerlies", arrow: "‚Üê"},
    {x: 646, y: 440, text: "Polar Easterlies", arrow: "‚Üí"}
  ];

  winds.forEach(w => {
    svg.append("text").attr("x", w.x).attr("y", w.y).attr("text-anchor", "middle").attr("font-size", 10).attr("fill", "#2d3436").text(w.text);
    svg.append("text").attr("x", w.x).attr("y", w.y + 18).attr("text-anchor", "middle").attr("font-size", 18).attr("fill", "#e74c3c").text(w.arrow);
  });

  // Rising/sinking labels
  svg.append("text").attr("x", 375).attr("y", 85).attr("text-anchor", "middle").attr("font-size", 11).attr("fill", "#e74c3c").text("‚Üë Rising (ITCZ)");
  svg.append("text").attr("x", 267).attr("y", 85).attr("text-anchor", "middle").attr("font-size", 11).attr("fill", "#e67e22").text("‚Üì Sinking");
  svg.append("text").attr("x", 483).attr("y", 85).attr("text-anchor", "middle").attr("font-size", 11).attr("fill", "#e67e22").text("‚Üì Sinking");
  svg.append("text").attr("x", 158).attr("y", 140).attr("text-anchor", "middle").attr("font-size", 11).attr("fill", "#3498db").text("‚Üë Rising");
  svg.append("text").attr("x", 592).attr("y", 140).attr("text-anchor", "middle").attr("font-size", 11).attr("fill", "#3498db").text("‚Üë Rising");

  // Jet stream markers
  svg.append("rect").attr("x", 140).attr("y", 170).attr("width", 36).attr("height", 20).attr("fill", "#f1c40f").attr("rx", 4);
  svg.append("text").attr("x", 158).attr("y", 185).attr("text-anchor", "middle").attr("font-size", 10).attr("font-weight", "bold").text("JET");
  svg.append("rect").attr("x", 249).attr("y", 125).attr("width", 36).attr("height", 20).attr("fill", "#f1c40f").attr("rx", 4);
  svg.append("text").attr("x", 267).attr("y", 140).attr("text-anchor", "middle").attr("font-size", 10).attr("font-weight", "bold").text("JET");

  svg.append("text").attr("x", 375).attr("y", 490).attr("text-anchor", "middle").attr("font-size", 12).attr("fill", "#636e72")
    .text("NYC sits in the WESTERLIES zone ‚Üí storms are steered from west/southwest to east/northeast");

  return svg.node();
}
```

::: {.key-idea}
### üí° Key Concept: Three Circulation Cells

| Cell | Latitude | Surface Winds | Key Feature |
|------|----------|---------------|-------------|
| **Hadley** | 0¬∞‚Äì30¬∞ | Trade Winds (NE in NH) | Rising air at equator ‚Üí heavy rain; sinking at 30¬∞ ‚Üí deserts |
| **Ferrel** | 30¬∞‚Äì60¬∞ | **Westerlies** | Driven by Hadley & Polar cells; steers mid-latitude weather from W‚ÜíE |
| **Polar** | 60¬∞‚Äì90¬∞ | Polar Easterlies | Cold, dry air sinking at poles |

**NYC is at ~41¬∞N ‚Äî right in the Ferrel Cell's westerlies.** This is why storms affecting our city generally move from southwest to northeast!
:::

## The Coriolis Effect: Why Winds Curve

If Earth didn't rotate, winds would blow straight from high to low pressure. But Earth **does** rotate, and this deflects moving air:

- **Northern Hemisphere:** winds curve to the **RIGHT**
- **Southern Hemisphere:** winds curve to the **LEFT**

```{ojs}
//| echo: false
viewof showCoriolis = Inputs.toggle({label: "Show Coriolis deflection", value: false})
```

```{ojs}
//| echo: false
{
  const width = 400;
  const height = 400;
  const svg = d3.create("svg").attr("width", width).attr("height", height).attr("viewBox", `0 0 ${width} ${height}`);

  // Earth from above (North Pole view)
  const cx = 200, cy = 200, r = 160;
  svg.append("circle").attr("cx", cx).attr("cy", cy).attr("r", r).attr("fill", "#e3f2fd").attr("stroke", "#1565c0").attr("stroke-width", 2);
  svg.append("text").attr("x", cx).attr("y", cy).attr("text-anchor", "middle").attr("font-size", 14).attr("font-weight", "bold").text("N. Pole (top view)");
  svg.append("text").attr("x", cx).attr("y", cy + 20).attr("text-anchor", "middle").attr("font-size", 20).text("‚Ü∫");
  svg.append("text").attr("x", cx).attr("y", cy + 40).attr("text-anchor", "middle").attr("font-size", 11).attr("fill", "#636e72").text("Earth rotates CCW");

  if (!showCoriolis) {
    // Straight path (no Coriolis)
    svg.append("line").attr("x1", cx).attr("y1", cy - r + 20).attr("x2", cx).attr("y2", cy + r - 20)
      .attr("stroke", "#2ecc71").attr("stroke-width", 3).attr("marker-end", "url(#arrowGreen)");
    svg.append("text").attr("x", cx + 15).attr("y", cy - 30).attr("font-size", 12).attr("fill", "#2ecc71").text("Expected path");
    svg.append("text").attr("x", cx + 15).attr("y", cy - 15).attr("font-size", 12).attr("fill", "#2ecc71").text("(no rotation)");
  } else {
    // Curved path (with Coriolis)
    svg.append("path").attr("d", `M ${cx},${cy - r + 20} Q ${cx + 80},${cy} ${cx + 40},${cy + r - 40}`)
      .attr("stroke", "#e74c3c").attr("stroke-width", 3).attr("fill", "none").attr("marker-end", "url(#arrowRed)");
    svg.append("text").attr("x", cx + 90).attr("y", cy - 10).attr("font-size", 12).attr("fill", "#e74c3c").text("Actual path");
    svg.append("text").attr("x", cx + 90).attr("y", cy + 5).attr("font-size", 12).attr("fill", "#e74c3c").text("(deflected RIGHT)");
    // Ghost straight path
    svg.append("line").attr("x1", cx).attr("y1", cy - r + 20).attr("x2", cx).attr("y2", cy + r - 20)
      .attr("stroke", "#2ecc71").attr("stroke-width", 1).attr("stroke-dasharray", "5,3");
  }

  const defs = svg.append("defs");
  defs.append("marker").attr("id", "arrowGreen").attr("viewBox", "0 0 10 10").attr("refX", 5).attr("refY", 5)
    .attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto-start-reverse")
    .append("path").attr("d", "M 0 0 L 10 5 L 0 10 z").attr("fill", "#2ecc71");
  defs.append("marker").attr("id", "arrowRed").attr("viewBox", "0 0 10 10").attr("refX", 5).attr("refY", 5)
    .attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto-start-reverse")
    .append("path").attr("d", "M 0 0 L 10 5 L 0 10 z").attr("fill", "#e74c3c");

  return svg.node();
}
```

::: {.key-idea}
### üí° Key Concept: Coriolis Effect + Pressure Gradient = Surface Winds

- Without Coriolis: wind blows straight from H ‚Üí L pressure
- With Coriolis (NH): wind is deflected **right** ‚Üí curves clockwise around High pressure, counter-clockwise around Low pressure
- This is why tropical trade winds blow from the **northeast** (not straight south) and mid-latitude westerlies blow from the **southwest** (not straight north)
:::

## The Jet Stream: The Storm Highway

At the boundary between the Ferrel and Polar cells (~60¬∞N, but it meanders), there is an extremely fast river of air flowing from west to east at high altitude: the **jet stream**.

```{ojs}
//| echo: false
viewof jetStreamPattern = Inputs.radio(
  ["Normal Pattern", "Wavy Pattern (Blocking)", "Climate Change Projection"],
  {label: "Jet stream configuration:", value: "Normal Pattern"}
)
```

```{ojs}
//| echo: false
{
  const width = 750;
  const height = 350;
  const svg = d3.create("svg").attr("width", width).attr("height", height).attr("viewBox", `0 0 ${width} ${height}`);

  svg.append("rect").attr("width", width).attr("height", height).attr("fill", "#f0f4ff").attr("rx", 10);

  // US outline simplified
  svg.append("rect").attr("x", 50).attr("y", 100).attr("width", 650).attr("height", 200).attr("fill", "#e8f5e9").attr("rx", 5);
  svg.append("text").attr("x", 100).attr("y", 130).attr("font-size", 11).attr("fill", "#4caf50").text("üá®üá¶ CANADA (cold air)");
  svg.append("text").attr("x", 100).attr("y", 280).attr("font-size", 11).attr("fill", "#ef5350").text("üå¥ SOUTH (warm air)");

  // Latitude reference
  svg.append("text").attr("x", 710).attr("y", 155).attr("font-size", 10).attr("fill", "#999").text("50¬∞N");
  svg.append("text").attr("x", 710).attr("y", 205).attr("font-size", 10).attr("fill", "#999").text("40¬∞N");
  svg.append("text").attr("x", 710).attr("y", 255).attr("font-size", 10).attr("fill", "#999").text("30¬∞N");

  if (jetStreamPattern === "Normal Pattern") {
    svg.append("path")
      .attr("d", "M 50,190 Q 200,170 350,195 Q 500,220 650,185 L 700,185")
      .attr("stroke", "#1565c0").attr("stroke-width", 5).attr("fill", "none");
    svg.append("text").attr("x", 375).attr("y", 160).attr("text-anchor", "middle").attr("font-size", 14).attr("font-weight", "bold").attr("fill", "#1565c0")
      .text("Polar Jet Stream (~200 mph)");
    svg.append("text").attr("x", 375).attr("y", 330).attr("text-anchor", "middle").attr("font-size", 13)
      .text("Gentle waves ‚Üí storms track steadily from west to east");
    // Storm riding the jet
    svg.append("text").attr("x", 400).attr("y", 205).attr("font-size", 20).text("üåÄ");
    svg.append("text").attr("x", 430).attr("y", 210).attr("font-size", 11).attr("fill", "#e74c3c").text("Storm steered by jet ‚Üí");
  } else if (jetStreamPattern === "Wavy Pattern (Blocking)") {
    svg.append("path")
      .attr("d", "M 50,190 Q 130,130 210,220 Q 290,300 370,180 Q 450,100 530,240 Q 610,310 700,190")
      .attr("stroke", "#e74c3c").attr("stroke-width", 5).attr("fill", "none");
    svg.append("text").attr("x", 375).attr("y", 80).attr("text-anchor", "middle").attr("font-size", 14).attr("font-weight", "bold").attr("fill", "#e74c3c")
      .text("Amplified Jet Stream (deep waves)");
    // Annotations
    svg.append("text").attr("x", 210).attr("y", 260).attr("text-anchor", "middle").attr("font-size", 11).text("‚ùÑÔ∏è Cold trough");
    svg.append("text").attr("x", 370).attr("y", 150).attr("text-anchor", "middle").attr("font-size", 11).text("üî• Warm ridge");
    svg.append("text").attr("x", 530).attr("y", 280).attr("text-anchor", "middle").attr("font-size", 11).text("‚ùÑÔ∏è Cold trough");
    svg.append("text").attr("x", 375).attr("y", 330).attr("text-anchor", "middle").attr("font-size", 13)
      .text("Deep waves ‚Üí cold air plunges south, warm air pushes north ‚Üí extreme weather STALLS");
  } else {
    svg.append("path")
      .attr("d", "M 50,195 Q 130,140 210,225 Q 290,300 370,180 Q 450,100 530,240 Q 610,310 700,190")
      .attr("stroke", "#e74c3c").attr("stroke-width", 4).attr("fill", "none").attr("stroke-dasharray", "8,4");
    svg.append("path")
      .attr("d", "M 50,190 Q 200,170 350,195 Q 500,220 650,185 L 700,185")
      .attr("stroke", "#1565c0").attr("stroke-width", 2).attr("fill", "none").attr("stroke-dasharray", "3,3");
    svg.append("text").attr("x", 375).attr("y", 80).attr("text-anchor", "middle").attr("font-size", 14).attr("font-weight", "bold").attr("fill", "#6c5ce7")
      .text("Climate Change ‚Üí More Frequent Amplified Patterns?");
    svg.append("text").attr("x", 200).attr("y", 155).attr("font-size", 11).attr("fill", "#1565c0").text("--- Historical pattern");
    svg.append("text").attr("x", 200).attr("y", 175).attr("font-size", 11).attr("fill", "#e74c3c").text("- - Future projection");
    svg.append("text").attr("x", 375).attr("y", 330).attr("text-anchor", "middle").attr("font-size", 13)
      .text("Arctic amplification may lead to more frequent blocking patterns ‚Üí more extreme storms");
  }

  return svg.node();
}
```

::: {.key-idea}
### üí° Key Concept: The Jet Stream Steers Storms

- The **polar jet stream** is a band of fast-moving air (100‚Äì200+ mph) at ~30,000 ft altitude
- It forms at the boundary between cold polar and warm tropical air
- Mid-latitude storms **ride the jet stream** from west to east
- **Stronger temperature gradient** ‚Üí faster, straighter jet ‚Üí predictable storm tracks
- **Weaker gradient (Arctic amplification)** ‚Üí slower, wavier jet ‚Üí storms can **stall**, creating extended extreme events
:::

# Elaborate: Precipitation Patterns & Climate Connections

::: {.elaborate-box}
## üåßÔ∏è Where Does It Rain (and Snow)?

Global circulation doesn't just create wind patterns ‚Äî it determines where on Earth gets rain and where stays dry.
:::

## Rising Air = Rain, Sinking Air = Dry

```{ojs}
//| echo: false
precipPatternData = [
  {lat: 0, name: "Equator (ITCZ)", precip: 2000, type: "Rising air ‚Üí heavy rain", emoji: "üåßÔ∏è"},
  {lat: 15, name: "15¬∞N", precip: 1200, type: "Transition", emoji: "üå§Ô∏è"},
  {lat: 30, name: "30¬∞N (Horse latitudes)", precip: 300, type: "Sinking air ‚Üí DESERTS", emoji: "üèúÔ∏è"},
  {lat: 45, name: "45¬∞N (Mid-latitudes)", precip: 1000, type: "Frontal lifting ‚Üí moderate rain", emoji: "üå¶Ô∏è"},
  {lat: 60, name: "60¬∞N (Polar front)", precip: 800, type: "Rising air ‚Üí rain/snow", emoji: "üå®Ô∏è"},
  {lat: 75, name: "75¬∞N", precip: 250, type: "Cold sinking air ‚Üí dry", emoji: "‚ùÑÔ∏è"},
  {lat: 90, name: "90¬∞N (Pole)", precip: 100, type: "Polar desert", emoji: "üßä"}
]

Plot.plot({
  title: "Average Annual Precipitation by Latitude",
  subtitle: "Rising air = wet; Sinking air = dry",
  width: 700,
  height: 380,
  x: {label: "Latitude (¬∞N)", domain: [0, 90]},
  y: {label: "Annual Precipitation (mm)", domain: [0, 2200]},
  marks: [
    Plot.barY(precipPatternData, {x: "lat", y: "precip", fill: d => d.precip > 800 ? "#3498db" : d.precip > 400 ? "#f39c12" : "#e74c3c", dx: -3}),
    Plot.text(precipPatternData, {x: "lat", y: d => d.precip + 80, text: "emoji", fontSize: 20}),
    Plot.text(precipPatternData, {x: "lat", y: d => d.precip + 150, text: "type", fontSize: 10})
  ]
})
```

::: {.student-task}
### üìù Connecting Circulation to Precipitation

1. Why does the equator receive so much rainfall? (Hint: think about the Hadley Cell)
2. Why are the world's great deserts located near 30¬∞N/S? (Sahara, Arabian, Mojave...)
3. NYC is at ~41¬∞N. What type of precipitation mechanism dominates there?
4. If global wind patterns **shifted northward** due to warming, how might precipitation patterns change for NYC?
:::

# Elaborate: Shifting Storm Paths

::: {.elaborate-box}
## üå°Ô∏è Could Climate Change Move Storm Tracks?

If the temperature gradient between the equator and poles changes, the circulation cells ‚Äî and the jet stream ‚Äî could shift. What would that mean for storms?
:::

```{ojs}
//| echo: false
viewof warmingScenario = Inputs.range([0, 4], {label: "Global warming (¬∞C above pre-industrial)", step: 0.5, value: 0})
```

```{ojs}
//| echo: false
{
  const width = 700;
  const height = 400;
  const svg = d3.create("svg").attr("width", width).attr("height", height).attr("viewBox", `0 0 ${width} ${height}`);

  svg.append("rect").attr("width", width).attr("height", height).attr("fill", "#f8f9fa").attr("rx", 10);
  svg.append("text").attr("x", 350).attr("y", 30).attr("text-anchor", "middle").attr("font-size", 16).attr("font-weight", "bold")
    .text(`Storm Track Shift with ${warmingScenario}¬∞C Warming`);

  // Latitude axis
  svg.append("line").attr("x1", 60).attr("y1", 360).attr("x2", 660).attr("y2", 360).attr("stroke", "#2d3436").attr("stroke-width", 2);
  const latLabels = ["20¬∞N", "30¬∞N", "40¬∞N", "50¬∞N", "60¬∞N", "70¬∞N"];
  latLabels.forEach((l, i) => {
    const x = 80 + i * 110;
    svg.append("text").attr("x", x).attr("y", 380).attr("text-anchor", "middle").attr("font-size", 11).text(l);
  });

  // Current storm track density (bell curve around 40-45¬∞N)
  const currentPeak = 300; // x position for 40¬∞N
  const shift = warmingScenario * 25; // shift northward with warming

  // Historical curve
  const points = d3.range(80, 640, 5).map(x => {
    const y = 300 * Math.exp(-0.5 * Math.pow((x - currentPeak) / 100, 2));
    return {x, y};
  });

  svg.append("path")
    .attr("d", d3.line().x(d => d.x).y(d => 350 - d.y).curve(d3.curveBasis)(points))
    .attr("stroke", "#3498db").attr("stroke-width", 2).attr("fill", "#3498db").attr("fill-opacity", 0.15)
    .attr("stroke-dasharray", warmingScenario > 0 ? "5,3" : "0");

  if (warmingScenario > 0) {
    // Shifted curve
    const shiftedPoints = d3.range(80, 640, 5).map(x => {
      const y = 280 * Math.exp(-0.5 * Math.pow((x - currentPeak - shift) / 120, 2));
      return {x, y};
    });

    svg.append("path")
      .attr("d", d3.line().x(d => d.x).y(d => 350 - d.y).curve(d3.curveBasis)(shiftedPoints))
      .attr("stroke", "#e74c3c").attr("stroke-width", 3).attr("fill", "#e74c3c").attr("fill-opacity", 0.2);
  }

  // NYC line
  svg.append("line").attr("x1", 310).attr("y1", 50).attr("x2", 310).attr("y2", 355).attr("stroke", "#2d3436").attr("stroke-width", 1).attr("stroke-dasharray", "3,3");
  svg.append("text").attr("x", 310).attr("y", 45).attr("text-anchor", "middle").attr("font-size", 12).attr("font-weight", "bold").text("NYC (41¬∞N)");

  // Legend
  svg.append("line").attr("x1", 450).attr("y1", 70).attr("x2", 500).attr("y2", 70).attr("stroke", "#3498db").attr("stroke-width", 2).attr("stroke-dasharray", warmingScenario > 0 ? "5,3" : "0");
  svg.append("text").attr("x", 510).attr("y", 74).attr("font-size", 11).text("Historical track density");
  if (warmingScenario > 0) {
    svg.append("line").attr("x1", 450).attr("y1", 90).attr("x2", 500).attr("y2", 90).attr("stroke", "#e74c3c").attr("stroke-width", 3);
    svg.append("text").attr("x", 510).attr("y", 94).attr("font-size", 11).attr("fill", "#e74c3c").text(`Projected (+${warmingScenario}¬∞C)`);
  }

  // Impact note
  if (warmingScenario >= 2) {
    svg.append("rect").attr("x", 100).attr("y", 270).attr("width", 500).attr("height", 50).attr("fill", "#fff3e0").attr("rx", 8);
    svg.append("text").attr("x", 350).attr("y", 293).attr("text-anchor", "middle").attr("font-size", 13).attr("font-weight", "bold").attr("fill", "#e65100")
      .text("‚ö†Ô∏è Storm tracks shift poleward ‚Äî NYC may see fewer but potentially stronger storms");
  }

  return svg.node();
}
```

::: {.mind-blown}
üåç As the planet warms, the jet stream and storm tracks are projected to shift **poleward** ‚Äî changing which regions get storms and how intense they are! üåç
:::

# Evaluate: Storm Path Analysis

::: {.evaluate-box}
## ‚úÖ Assessment: Explaining Storm Trajectories
:::

::: {.quiz-section}
### üß† Check Your Understanding

**Question 1:** The prevailing westerlies that steer storms across the mid-latitudes are ultimately caused by:

```{ojs}
//| echo: false
viewof q1_paths = Inputs.radio(
  ["The Moon's gravitational pull on the atmosphere",
   "Uneven solar heating between the equator and poles, combined with Earth's rotation",
   "Ocean currents pushing the air along",
   "Volcanic eruptions changing the atmosphere"],
  {label: "Select the best answer:"}
)
```

```{ojs}
//| echo: false
q1_paths === "Uneven solar heating between the equator and poles, combined with Earth's rotation" ? 
  html`<div style="background: #d4edda; padding: 12px; border-radius: 8px; border-left: 4px solid #28a745;">‚úÖ <strong>Correct!</strong> Uneven heating drives convection (the Hadley, Ferrel, and Polar cells). Earth's rotation (Coriolis effect) deflects these winds, creating the westerlies in the mid-latitudes.</div>` :
  q1_paths ? html`<div style="background: #f8d7da; padding: 12px; border-radius: 8px; border-left: 4px solid #dc3545;">‚ùå Think about what creates pressure differences globally, and what deflects the wind.</div>` : html``
```

**Question 2:** Why do both hurricanes (after recurvature) and Nor'easters travel from southwest to northeast?

```{ojs}
//| echo: false
viewof q2_paths = Inputs.radio(
  ["They are pushed by ocean tides",
   "They are both steered by the mid-latitude westerlies and jet stream",
   "They generate their own westward momentum",
   "The Coriolis effect pushes all storms to the northeast"],
  {label: "Select the best answer:"}
)
```

```{ojs}
//| echo: false
q2_paths === "They are both steered by the mid-latitude westerlies and jet stream" ? 
  html`<div style="background: #d4edda; padding: 12px; border-radius: 8px; border-left: 4px solid #28a745;">‚úÖ <strong>Correct!</strong> Once a storm enters the mid-latitudes (30¬∞‚Äì60¬∞N), it gets picked up by the westerlies and jet stream, which steer it from southwest to northeast regardless of how it formed.</div>` :
  q2_paths ? html`<div style="background: #f8d7da; padding: 12px; border-radius: 8px; border-left: 4px solid #dc3545;">‚ùå Think about what moves air in the 30¬∞‚Äì60¬∞ latitude band.</div>` : html``
```

**Question 3:** How might Arctic amplification change storm paths in the future?

```{ojs}
//| echo: false
viewof q3_paths = Inputs.radio(
  ["Storms would stop entirely",
   "The weakened temperature gradient could slow the jet stream and create more persistent, wavy patterns",
   "Storms would reverse direction and move east to west",
   "Arctic amplification has no effect on mid-latitude weather"],
  {label: "Select the best answer:"}
)
```

```{ojs}
//| echo: false
q3_paths === "The weakened temperature gradient could slow the jet stream and create more persistent, wavy patterns" ? 
  html`<div style="background: #d4edda; padding: 12px; border-radius: 8px; border-left: 4px solid #28a745;">‚úÖ <strong>Excellent!</strong> The jet stream's speed depends on the temperature contrast between polar and tropical air. Arctic amplification reduces this contrast, potentially causing the jet to develop larger, slower-moving waves. This means storms can stall and produce prolonged extreme weather.</div>` :
  q3_paths ? html`<div style="background: #f8d7da; padding: 12px; border-radius: 8px; border-left: 4px solid #dc3545;">‚ùå Think about what drives the jet stream (temperature gradient) and what happens when the Arctic warms faster than the tropics.</div>` : html``
```
:::

::: {.lab-activity}
### üìù Culminating Task: Storm Path Investigation

Using the concepts from this chapter, write a **scientific explanation** that addresses:

**"Why do blizzards and hurricanes follow the paths they do, and how might those paths change in the future?"**

Your explanation should reference:

1. **Uneven solar heating** and how it creates atmospheric circulation cells
2. **The Coriolis effect** and how it shapes surface wind patterns
3. **The jet stream** and its role as a storm highway
4. **Arctic amplification** and how it may alter the jet stream
5. A **prediction** about how NYC's storm exposure could change

Support your explanation with at least **three pieces of evidence** from data or diagrams in this chapter.
:::

# Summary: Key Takeaways

| Concept | Key Idea |
|---------|----------|
| **Uneven heating** | Equator gets more solar energy ‚Üí drives convection cells |
| **Convection cells** | Hadley, Ferrel, Polar cells redistribute heat globally |
| **Coriolis effect** | Earth's rotation deflects winds ‚Üí creates prevailing wind patterns |
| **Westerlies** | Dominant winds in 30¬∞‚Äì60¬∞ latitude ‚Üí steer storms SW ‚Üí NE |
| **Jet stream** | Fast upper-level winds at cell boundaries ‚Üí storm "highway" |
| **Arctic amplification** | Reduced gradient ‚Üí wavier jet stream ‚Üí storms may stall or shift |
| **Storm tracks** | Both hurricanes and blizzards are steered by the same global winds |

**Next up:** We'll investigate **how hurricanes form** and why they only occur during certain months. üåÄ
