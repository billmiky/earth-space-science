{
  "hash": "d12e8581ae37d8fe388b2e72cdc3ac78",
  "result": {
    "engine": "jupyter",
    "markdown": "# Energy Flow and Climate Patterns\n\n## Essential Question\n\n> How does energy flow through Earth's climate system create weather and climate patterns?\n\n## Earth's Energy Budget\n\nEarth receives energy from the Sun and radiates energy back to space. The balance determines our planet's temperature.\n\n::: {#cell-fig-energy-budget .cell execution_count=1}\n``` {.python .cell-code code-fold=\"true\"}\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\nimport matplotlib.patches as FancyArrowPatch\n\nfig, ax = plt.subplots(figsize=(14, 10))\nax.set_xlim(0, 14)\nax.set_ylim(0, 12)\nax.axis('off')\n\n# Space\nax.add_patch(mpatches.Rectangle((0, 9), 14, 3, facecolor='#1a1a2e'))\nax.text(7, 11, 'SPACE', ha='center', fontsize=14, color='white', fontweight='bold')\n\n# Atmosphere\nax.add_patch(mpatches.Rectangle((0, 4), 14, 5, facecolor='#87CEEB', alpha=0.5))\nax.text(7, 6.5, 'ATMOSPHERE', ha='center', fontsize=12, fontweight='bold')\n\n# Surface\nax.add_patch(mpatches.Rectangle((0, 0), 14, 4, facecolor='#228B22'))\nax.add_patch(mpatches.Rectangle((8, 0), 6, 4, facecolor='#1E90FF'))\nax.text(4, 2, 'LAND', ha='center', fontsize=12, fontweight='bold')\nax.text(11, 2, 'OCEAN', ha='center', fontsize=12, fontweight='bold', color='white')\n\n# Incoming solar (left side)\nax.annotate('', xy=(3, 9), xytext=(3, 11.5), \n            arrowprops=dict(arrowstyle='->', color='#FFD700', lw=4))\nax.text(3, 11.7, 'Incoming Solar\\n340 W/m²', ha='center', fontsize=10, color='#FFD700')\n\n# Reflected by atmosphere\nax.annotate('', xy=(1.5, 11.5), xytext=(1.5, 7),\n            arrowprops=dict(arrowstyle='->', color='yellow', lw=2))\nax.text(0.5, 8, 'Reflected by\\nclouds/atmosphere\\n~79 W/m²', ha='center', fontsize=8)\n\n# Reflected by surface\nax.annotate('', xy=(5, 11.5), xytext=(5, 4),\n            arrowprops=dict(arrowstyle='->', color='yellow', lw=2))\nax.text(5.5, 6, 'Reflected by\\nsurface\\n~23 W/m²', ha='center', fontsize=8)\n\n# Absorbed by surface\nax.annotate('', xy=(7, 4), xytext=(7, 9),\n            arrowprops=dict(arrowstyle='->', color='orange', lw=3))\nax.text(7.5, 6.5, 'Absorbed by\\nsurface\\n~163 W/m²', ha='center', fontsize=9)\n\n# Absorbed by atmosphere\nax.annotate('', xy=(4, 6), xytext=(4, 9),\n            arrowprops=dict(arrowstyle='->', color='orange', lw=2))\nax.text(4, 7.8, 'Absorbed by\\natmosphere\\n~75 W/m²', ha='center', fontsize=8)\n\n# Outgoing radiation (right side)\n# Surface radiation\nax.annotate('', xy=(10, 9), xytext=(10, 4),\n            arrowprops=dict(arrowstyle='->', color='red', lw=3))\nax.text(10.5, 5.5, 'Surface\\nradiation\\n~398 W/m²', ha='center', fontsize=9)\n\n# Greenhouse effect - absorbed and re-emitted\nax.annotate('', xy=(11.5, 4), xytext=(11.5, 7),\n            arrowprops=dict(arrowstyle='->', color='#FF6347', lw=2))\nax.text(12.5, 5.5, 'Back\\nradiation\\n~340 W/m²', ha='center', fontsize=8)\n\n# To space\nax.annotate('', xy=(12, 11.5), xytext=(12, 9),\n            arrowprops=dict(arrowstyle='->', color='darkred', lw=3))\nax.text(13, 10, 'Outgoing\\n~239 W/m²', ha='center', fontsize=9, color='darkred')\n\n# Latent/sensible heat\nax.annotate('', xy=(9, 6), xytext=(9, 4),\n            arrowprops=dict(arrowstyle='->', color='purple', lw=2))\nax.text(8.5, 5, 'Latent &\\nSensible\\nHeat', ha='center', fontsize=8, color='purple')\n\nax.set_title(\"Earth's Energy Budget\", fontsize=16, fontweight='bold', y=1.02)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Earth's energy budget showing incoming and outgoing energy](03-energy-flow-climate_files/figure-html/fig-energy-budget-output-1.png){#fig-energy-budget}\n:::\n:::\n\n\n## The Greenhouse Effect\n\nGreenhouse gases trap heat in the atmosphere, keeping Earth warm enough for life.\n\n::: {#fig-greenhouse-gases .cell execution_count=2}\n``` {.python .cell-code code-fold=\"true\"}\nimport plotly.express as px\nimport pandas as pd\n\ngases = pd.DataFrame({\n    'Gas': ['Water Vapor', 'Carbon Dioxide', 'Methane', 'Nitrous Oxide', 'Ozone', 'CFCs'],\n    'Contribution (%)': [36, 20, 6, 3, 3, 2],\n    'Human Caused': ['Indirect', 'Yes', 'Yes', 'Yes', 'Partial', 'Yes'],\n    'Lifetime (years)': ['Days', '100-300', '12', '120', 'Weeks', '100+']\n})\n\nfig = px.pie(gases, values='Contribution (%)', names='Gas',\n             title='Greenhouse Gas Contributions to Warming',\n             color_discrete_sequence=['#3b82f6', '#ef4444', '#f97316', '#a855f7', '#22c55e', '#64748b'],\n             hover_data=['Human Caused', 'Lifetime (years)'])\nfig.update_traces(textposition='inside', textinfo='percent+label')\nfig.update_layout(height=450)\nfig.show()\n```\n\n::: {#fig-greenhouse-gases-1 .cell-output .cell-output-display}\n```{=html}\n        <script type=\"text/javascript\">\n        window.PlotlyConfig = {MathJaxConfig: 'local'};\n        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n        </script>\n        <script type=\"module\">import \"https://cdn.plot.ly/plotly-3.3.1.min\"</script>\n        \n```\n\nContribution of different greenhouse gases to warming\n:::\n\n::: {#fig-greenhouse-gases-2 .cell-output .cell-output-display}\n```{=html}\n<div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.3.1.min.js\" integrity=\"sha256-4rD3fugVb/nVJYUv5Ky3v+fYXoouHaBSP20WIJuEiWg=\" crossorigin=\"anonymous\"></script>                <div id=\"e3083edb-0879-467b-9cf2-d3e319f0922b\" class=\"plotly-graph-div\" style=\"height:450px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"e3083edb-0879-467b-9cf2-d3e319f0922b\")) {                    Plotly.newPlot(                        \"e3083edb-0879-467b-9cf2-d3e319f0922b\",                        [{\"customdata\":[[\"Indirect\",\"Days\"],[\"Yes\",\"100-300\"],[\"Yes\",\"12\"],[\"Yes\",\"120\"],[\"Partial\",\"Weeks\"],[\"Yes\",\"100+\"]],\"domain\":{\"x\":[0.0,1.0],\"y\":[0.0,1.0]},\"hovertemplate\":\"Gas=%{label}\\u003cbr\\u003eContribution (%)=%{value}\\u003cbr\\u003eHuman Caused=%{customdata[0]}\\u003cbr\\u003eLifetime (years)=%{customdata[1]}\\u003cextra\\u003e\\u003c\\u002fextra\\u003e\",\"labels\":[\"Water Vapor\",\"Carbon Dioxide\",\"Methane\",\"Nitrous Oxide\",\"Ozone\",\"CFCs\"],\"legendgroup\":\"\",\"name\":\"\",\"showlegend\":true,\"values\":{\"dtype\":\"i1\",\"bdata\":\"JBQGAwMC\"},\"type\":\"pie\",\"textinfo\":\"percent+label\",\"textposition\":\"inside\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30}}},\"legend\":{\"tracegroupgap\":0},\"title\":{\"text\":\"Greenhouse Gas Contributions to Warming\"},\"piecolorway\":[\"#3b82f6\",\"#ef4444\",\"#f97316\",\"#a855f7\",\"#22c55e\",\"#64748b\"],\"height\":450},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('e3083edb-0879-467b-9cf2-d3e319f0922b');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };            </script>        </div>\n```\n:::\n:::\n\n\n## Interactive: Greenhouse Effect Model\n\n\n```{ojs}\n//| echo: false\n\nviewof co2Level = Inputs.range([280, 800], {\n  value: 420,\n  step: 10,\n  label: \"CO₂ Concentration (ppm)\"\n})\n\nviewof ch4Level = Inputs.range([700, 3000], {\n  value: 1900,\n  step: 50,\n  label: \"Methane (ppb)\"\n})\n\nviewof albedoValue = Inputs.range([0.2, 0.4], {\n  value: 0.30,\n  step: 0.01,\n  label: \"Planetary Albedo\"\n})\n\n// Calculate temperature (simplified radiative model)\nsolarConstant = 1361\nabsorbed = solarConstant/4 * (1 - albedoValue)\nstefanBoltzmann = 5.67e-8\n\n// Greenhouse factor (simplified)\nghFactor = 1 + 0.3 * Math.log(co2Level/280) + 0.1 * Math.log(ch4Level/700)\n\neffectiveTemp = Math.pow(absorbed / stefanBoltzmann, 0.25) - 273.15\nsurfaceTemp = effectiveTemp + 33 * ghFactor\n\npreindustrialTemp = 14\ntempAnomaly = surfaceTemp - preindustrialTemp\n```\n\n```{ojs}\n//| echo: false\n\nhtml`\n<div class=\"interactive-container\">\n  <h3>Greenhouse Effect Model</h3>\n  \n  <div style=\"display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 15px 0;\">\n    <div style=\"background: #fef2f2; padding: 15px; border-radius: 8px; text-align: center;\">\n      <div style=\"font-size: 32px; font-weight: bold; color: #dc2626;\">${surfaceTemp.toFixed(1)}°C</div>\n      <div>Global Mean Temperature</div>\n    </div>\n    <div style=\"background: ${tempAnomaly > 0 ? '#fef2f2' : '#f0fdf4'}; padding: 15px; border-radius: 8px; text-align: center;\">\n      <div style=\"font-size: 32px; font-weight: bold; color: ${tempAnomaly > 0 ? '#dc2626' : '#16a34a'};\">\n        ${tempAnomaly > 0 ? '+' : ''}${tempAnomaly.toFixed(2)}°C\n      </div>\n      <div>Anomaly from Pre-industrial</div>\n    </div>\n    <div style=\"background: #eff6ff; padding: 15px; border-radius: 8px; text-align: center;\">\n      <div style=\"font-size: 32px; font-weight: bold; color: #2563eb;\">${ghFactor.toFixed(2)}</div>\n      <div>Greenhouse Factor</div>\n    </div>\n  </div>\n  \n  <div style=\"background: #f8fafc; padding: 15px; border-radius: 8px;\">\n    <strong>Analysis:</strong>\n    <ul style=\"margin: 10px 0;\">\n      <li>Pre-industrial CO₂: 280 ppm → Current: ${co2Level} ppm (${((co2Level/280 - 1) * 100).toFixed(0)}% increase)</li>\n      <li>Without greenhouse effect, Earth would be ${(-effectiveTemp).toFixed(0)}°C (frozen!)</li>\n      <li>${tempAnomaly > 1.5 ? \"⚠️ Exceeds Paris Agreement 1.5°C target!\" : \n           tempAnomaly > 1 ? \"⚠️ Approaching dangerous warming levels\" :\n           \"Within relatively safe warming range\"}</li>\n    </ul>\n  </div>\n</div>\n`\n```\n\n\n## Global Circulation Patterns\n\nUneven heating of Earth creates global wind and ocean circulation patterns.\n\n::: {#cell-fig-circulation .cell execution_count=3}\n``` {.python .cell-code code-fold=\"true\"}\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\nimport numpy as np\n\nfig, ax = plt.subplots(figsize=(14, 8))\nax.set_xlim(-180, 180)\nax.set_ylim(-90, 90)\n\n# Background\nax.set_facecolor('#1E90FF')\n\n# Continents (simplified)\nax.add_patch(mpatches.Rectangle((-130, 15), 60, 60, facecolor='#228B22', alpha=0.7))  # North America\nax.add_patch(mpatches.Rectangle((-80, -60), 40, 70, facecolor='#228B22', alpha=0.7))   # South America\nax.add_patch(mpatches.Rectangle((-20, -35), 60, 80, facecolor='#228B22', alpha=0.7))   # Africa\nax.add_patch(mpatches.Rectangle((40, 10), 100, 60, facecolor='#228B22', alpha=0.7))    # Asia\nax.add_patch(mpatches.Rectangle((110, -45), 50, 35, facecolor='#228B22', alpha=0.7))   # Australia\n\n# Circulation cells\ncells = [\n    (0, 30, 'Hadley Cell', '#ff6b6b'),\n    (30, 60, 'Ferrel Cell', '#4ecdc4'),\n    (60, 90, 'Polar Cell', '#45b7d1'),\n    (0, -30, 'Hadley Cell', '#ff6b6b'),\n    (-30, -60, 'Ferrel Cell', '#4ecdc4'),\n    (-60, -90, 'Polar Cell', '#45b7d1')\n]\n\nfor y1, y2, name, color in cells:\n    # Draw cell\n    y_mid = (y1 + y2) / 2\n    for x in [-120, 0, 120]:\n        # Rising air\n        if 'Hadley' in name:\n            ax.annotate('', xy=(x-20, max(y1, y2)), xytext=(x-20, min(y1, y2)),\n                       arrowprops=dict(arrowstyle='->', color=color, lw=2))\n            ax.annotate('', xy=(x+20, min(y1, y2)), xytext=(x+20, max(y1, y2)),\n                       arrowprops=dict(arrowstyle='->', color=color, lw=2))\n        \n    ax.text(0, y_mid, name, ha='center', va='center', fontsize=10, \n            fontweight='bold', color='white',\n            bbox=dict(boxstyle='round', facecolor=color, alpha=0.8))\n\n# Wind belts\nwinds = [\n    (5, 'Trade Winds (NE)', '←'),\n    (-5, 'Trade Winds (SE)', '←'),\n    (45, 'Westerlies', '→'),\n    (-45, 'Westerlies', '→'),\n    (75, 'Polar Easterlies', '←'),\n    (-75, 'Polar Easterlies', '←')\n]\n\nfor lat, name, direction in winds:\n    ax.text(160, lat, f'{direction} {name}', fontsize=9, va='center', color='yellow')\n\n# Latitude labels\nfor lat in [-60, -30, 0, 30, 60]:\n    ax.axhline(y=lat, color='white', linestyle='--', alpha=0.3)\n    ax.text(-175, lat, f'{abs(lat)}°{\"N\" if lat > 0 else \"S\" if lat < 0 else \"\"}', \n            fontsize=9, color='white', va='center')\n\nax.text(0, 0, 'EQUATOR', ha='center', fontsize=10, color='white', fontweight='bold')\n\nax.set_xlabel('Longitude', fontsize=12)\nax.set_ylabel('Latitude', fontsize=12)\nax.set_title('Global Atmospheric Circulation', fontsize=14, fontweight='bold')\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Global atmospheric circulation cells](03-energy-flow-climate_files/figure-html/fig-circulation-output-1.png){#fig-circulation}\n:::\n:::\n\n\n## Ocean Currents\n\nOcean currents redistribute heat around the globe, moderating climate.\n\n::: {#cell-fig-thermohaline .cell execution_count=4}\n``` {.python .cell-code code-fold=\"true\"}\nimport plotly.graph_objects as go\n\nfig = go.Figure()\n\n# Warm surface currents (red)\nwarm_lats = [0, 20, 40, 55, 60, 55, 40, 30, 0, -30, -50, -60, -50, -30, 0]\nwarm_lons = [-80, -60, -40, -20, 0, 20, 40, 60, 80, 100, 120, 150, 180, -150, -120]\n\nfig.add_trace(go.Scattergeo(\n    lat=warm_lats,\n    lon=warm_lons,\n    mode='lines',\n    line=dict(width=4, color='red'),\n    name='Warm Surface Current'\n))\n\n# Cold deep currents (blue)\ncold_lats = [60, 40, 20, 0, -20, -40, -60, -50, -30, 0, 20, 40]\ncold_lons = [0, -20, -40, -60, -80, -100, -120, -150, 180, 150, 120, 90]\n\nfig.add_trace(go.Scattergeo(\n    lat=cold_lats,\n    lon=cold_lons,\n    mode='lines',\n    line=dict(width=4, color='blue'),\n    name='Cold Deep Current'\n))\n\n# Sinking regions\nfig.add_trace(go.Scattergeo(\n    lat=[65, -65],\n    lon=[-30, 0],\n    mode='markers+text',\n    marker=dict(size=15, color='darkblue', symbol='arrow-down'),\n    text=['North Atlantic\\nDeep Water', 'Antarctic\\nBottom Water'],\n    textposition='bottom center',\n    name='Sinking Zones'\n))\n\nfig.update_geos(\n    projection_type='natural earth',\n    showland=True, landcolor='lightgray',\n    showocean=True, oceancolor='lightblue'\n)\n\nfig.update_layout(\n    title='Global Thermohaline Circulation',\n    height=500\n)\nfig.show()\n```\n\n::: {#fig-thermohaline .cell-output .cell-output-display}\n```{=html}\n<div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.3.1.min.js\" integrity=\"sha256-4rD3fugVb/nVJYUv5Ky3v+fYXoouHaBSP20WIJuEiWg=\" crossorigin=\"anonymous\"></script>                <div id=\"0603f2f2-b59e-4f53-81f9-7dbdd75841d7\" class=\"plotly-graph-div\" style=\"height:500px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"0603f2f2-b59e-4f53-81f9-7dbdd75841d7\")) {                    Plotly.newPlot(                        \"0603f2f2-b59e-4f53-81f9-7dbdd75841d7\",                        [{\"lat\":[0,20,40,55,60,55,40,30,0,-30,-50,-60,-50,-30,0],\"line\":{\"color\":\"red\",\"width\":4},\"lon\":[-80,-60,-40,-20,0,20,40,60,80,100,120,150,180,-150,-120],\"mode\":\"lines\",\"name\":\"Warm Surface Current\",\"type\":\"scattergeo\"},{\"lat\":[60,40,20,0,-20,-40,-60,-50,-30,0,20,40],\"line\":{\"color\":\"blue\",\"width\":4},\"lon\":[0,-20,-40,-60,-80,-100,-120,-150,180,150,120,90],\"mode\":\"lines\",\"name\":\"Cold Deep Current\",\"type\":\"scattergeo\"},{\"lat\":[65,-65],\"lon\":[-30,0],\"marker\":{\"color\":\"darkblue\",\"size\":15,\"symbol\":\"arrow-down\"},\"mode\":\"markers+text\",\"name\":\"Sinking Zones\",\"text\":[\"North Atlantic\\nDeep Water\",\"Antarctic\\nBottom Water\"],\"textposition\":\"bottom center\",\"type\":\"scattergeo\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30}}},\"geo\":{\"projection\":{\"type\":\"natural earth\"},\"showland\":true,\"landcolor\":\"lightgray\",\"showocean\":true,\"oceancolor\":\"lightblue\"},\"title\":{\"text\":\"Global Thermohaline Circulation\"},\"height\":500},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('0603f2f2-b59e-4f53-81f9-7dbdd75841d7');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };            </script>        </div>\n```\n\nThe global thermohaline circulation (ocean conveyor belt)\n:::\n:::\n\n\n## Check Your Understanding\n\n::: {.callout-note}\n## Questions\n1. Why doesn't all of the Sun's energy reach Earth's surface?\n2. Explain how the greenhouse effect keeps Earth warm enough for life.\n3. What causes global wind patterns like the trade winds and westerlies?\n4. How do ocean currents affect climate in coastal regions?\n:::\n\n",
    "supporting": [
      "03-energy-flow-climate_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}