{"title":"Energy Flow and Climate Patterns","markdown":{"headingText":"Energy Flow and Climate Patterns","containsRefs":false,"markdown":"\n## Essential Question\n\n> How does energy flow through Earth's climate system create weather and climate patterns?\n\n## Earth's Energy Budget\n\nEarth receives energy from the Sun and radiates energy back to space. The balance determines our planet's temperature.\n\n```{python}\n#| label: fig-energy-budget\n#| fig-cap: \"Earth's energy budget showing incoming and outgoing energy\"\n#| code-fold: true\n\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\nimport matplotlib.patches as FancyArrowPatch\n\nfig, ax = plt.subplots(figsize=(14, 10))\nax.set_xlim(0, 14)\nax.set_ylim(0, 12)\nax.axis('off')\n\n# Space\nax.add_patch(mpatches.Rectangle((0, 9), 14, 3, facecolor='#1a1a2e'))\nax.text(7, 11, 'SPACE', ha='center', fontsize=14, color='white', fontweight='bold')\n\n# Atmosphere\nax.add_patch(mpatches.Rectangle((0, 4), 14, 5, facecolor='#87CEEB', alpha=0.5))\nax.text(7, 6.5, 'ATMOSPHERE', ha='center', fontsize=12, fontweight='bold')\n\n# Surface\nax.add_patch(mpatches.Rectangle((0, 0), 14, 4, facecolor='#228B22'))\nax.add_patch(mpatches.Rectangle((8, 0), 6, 4, facecolor='#1E90FF'))\nax.text(4, 2, 'LAND', ha='center', fontsize=12, fontweight='bold')\nax.text(11, 2, 'OCEAN', ha='center', fontsize=12, fontweight='bold', color='white')\n\n# Incoming solar (left side)\nax.annotate('', xy=(3, 9), xytext=(3, 11.5), \n            arrowprops=dict(arrowstyle='->', color='#FFD700', lw=4))\nax.text(3, 11.7, 'Incoming Solar\\n340 W/m²', ha='center', fontsize=10, color='#FFD700')\n\n# Reflected by atmosphere\nax.annotate('', xy=(1.5, 11.5), xytext=(1.5, 7),\n            arrowprops=dict(arrowstyle='->', color='yellow', lw=2))\nax.text(0.5, 8, 'Reflected by\\nclouds/atmosphere\\n~79 W/m²', ha='center', fontsize=8)\n\n# Reflected by surface\nax.annotate('', xy=(5, 11.5), xytext=(5, 4),\n            arrowprops=dict(arrowstyle='->', color='yellow', lw=2))\nax.text(5.5, 6, 'Reflected by\\nsurface\\n~23 W/m²', ha='center', fontsize=8)\n\n# Absorbed by surface\nax.annotate('', xy=(7, 4), xytext=(7, 9),\n            arrowprops=dict(arrowstyle='->', color='orange', lw=3))\nax.text(7.5, 6.5, 'Absorbed by\\nsurface\\n~163 W/m²', ha='center', fontsize=9)\n\n# Absorbed by atmosphere\nax.annotate('', xy=(4, 6), xytext=(4, 9),\n            arrowprops=dict(arrowstyle='->', color='orange', lw=2))\nax.text(4, 7.8, 'Absorbed by\\natmosphere\\n~75 W/m²', ha='center', fontsize=8)\n\n# Outgoing radiation (right side)\n# Surface radiation\nax.annotate('', xy=(10, 9), xytext=(10, 4),\n            arrowprops=dict(arrowstyle='->', color='red', lw=3))\nax.text(10.5, 5.5, 'Surface\\nradiation\\n~398 W/m²', ha='center', fontsize=9)\n\n# Greenhouse effect - absorbed and re-emitted\nax.annotate('', xy=(11.5, 4), xytext=(11.5, 7),\n            arrowprops=dict(arrowstyle='->', color='#FF6347', lw=2))\nax.text(12.5, 5.5, 'Back\\nradiation\\n~340 W/m²', ha='center', fontsize=8)\n\n# To space\nax.annotate('', xy=(12, 11.5), xytext=(12, 9),\n            arrowprops=dict(arrowstyle='->', color='darkred', lw=3))\nax.text(13, 10, 'Outgoing\\n~239 W/m²', ha='center', fontsize=9, color='darkred')\n\n# Latent/sensible heat\nax.annotate('', xy=(9, 6), xytext=(9, 4),\n            arrowprops=dict(arrowstyle='->', color='purple', lw=2))\nax.text(8.5, 5, 'Latent &\\nSensible\\nHeat', ha='center', fontsize=8, color='purple')\n\nax.set_title(\"Earth's Energy Budget\", fontsize=16, fontweight='bold', y=1.02)\n\nplt.tight_layout()\nplt.show()\n```\n\n## The Greenhouse Effect\n\nGreenhouse gases trap heat in the atmosphere, keeping Earth warm enough for life.\n\n```{python}\n#| label: fig-greenhouse-gases\n#| fig-cap: \"Contribution of different greenhouse gases to warming\"\n#| code-fold: true\n\nimport plotly.express as px\nimport pandas as pd\n\ngases = pd.DataFrame({\n    'Gas': ['Water Vapor', 'Carbon Dioxide', 'Methane', 'Nitrous Oxide', 'Ozone', 'CFCs'],\n    'Contribution (%)': [36, 20, 6, 3, 3, 2],\n    'Human Caused': ['Indirect', 'Yes', 'Yes', 'Yes', 'Partial', 'Yes'],\n    'Lifetime (years)': ['Days', '100-300', '12', '120', 'Weeks', '100+']\n})\n\nfig = px.pie(gases, values='Contribution (%)', names='Gas',\n             title='Greenhouse Gas Contributions to Warming',\n             color_discrete_sequence=['#3b82f6', '#ef4444', '#f97316', '#a855f7', '#22c55e', '#64748b'],\n             hover_data=['Human Caused', 'Lifetime (years)'])\nfig.update_traces(textposition='inside', textinfo='percent+label')\nfig.update_layout(height=450)\nfig.show()\n```\n\n## Interactive: Greenhouse Effect Model\n\n```{ojs}\n//| echo: false\n\nviewof co2Level = Inputs.range([280, 800], {\n  value: 420,\n  step: 10,\n  label: \"CO₂ Concentration (ppm)\"\n})\n\nviewof ch4Level = Inputs.range([700, 3000], {\n  value: 1900,\n  step: 50,\n  label: \"Methane (ppb)\"\n})\n\nviewof albedoValue = Inputs.range([0.2, 0.4], {\n  value: 0.30,\n  step: 0.01,\n  label: \"Planetary Albedo\"\n})\n\n// Calculate temperature (simplified radiative model)\nsolarConstant = 1361\nabsorbed = solarConstant/4 * (1 - albedoValue)\nstefanBoltzmann = 5.67e-8\n\n// Greenhouse factor (simplified)\nghFactor = 1 + 0.3 * Math.log(co2Level/280) + 0.1 * Math.log(ch4Level/700)\n\neffectiveTemp = Math.pow(absorbed / stefanBoltzmann, 0.25) - 273.15\nsurfaceTemp = effectiveTemp + 33 * ghFactor\n\npreindustrialTemp = 14\ntempAnomaly = surfaceTemp - preindustrialTemp\n```\n\n```{ojs}\n//| echo: false\n\nhtml`\n<div class=\"interactive-container\">\n  <h3>Greenhouse Effect Model</h3>\n  \n  <div style=\"display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 15px 0;\">\n    <div style=\"background: #fef2f2; padding: 15px; border-radius: 8px; text-align: center;\">\n      <div style=\"font-size: 32px; font-weight: bold; color: #dc2626;\">${surfaceTemp.toFixed(1)}°C</div>\n      <div>Global Mean Temperature</div>\n    </div>\n    <div style=\"background: ${tempAnomaly > 0 ? '#fef2f2' : '#f0fdf4'}; padding: 15px; border-radius: 8px; text-align: center;\">\n      <div style=\"font-size: 32px; font-weight: bold; color: ${tempAnomaly > 0 ? '#dc2626' : '#16a34a'};\">\n        ${tempAnomaly > 0 ? '+' : ''}${tempAnomaly.toFixed(2)}°C\n      </div>\n      <div>Anomaly from Pre-industrial</div>\n    </div>\n    <div style=\"background: #eff6ff; padding: 15px; border-radius: 8px; text-align: center;\">\n      <div style=\"font-size: 32px; font-weight: bold; color: #2563eb;\">${ghFactor.toFixed(2)}</div>\n      <div>Greenhouse Factor</div>\n    </div>\n  </div>\n  \n  <div style=\"background: #f8fafc; padding: 15px; border-radius: 8px;\">\n    <strong>Analysis:</strong>\n    <ul style=\"margin: 10px 0;\">\n      <li>Pre-industrial CO₂: 280 ppm → Current: ${co2Level} ppm (${((co2Level/280 - 1) * 100).toFixed(0)}% increase)</li>\n      <li>Without greenhouse effect, Earth would be ${(-effectiveTemp).toFixed(0)}°C (frozen!)</li>\n      <li>${tempAnomaly > 1.5 ? \"⚠️ Exceeds Paris Agreement 1.5°C target!\" : \n           tempAnomaly > 1 ? \"⚠️ Approaching dangerous warming levels\" :\n           \"Within relatively safe warming range\"}</li>\n    </ul>\n  </div>\n</div>\n`\n```\n\n## Global Circulation Patterns\n\nUneven heating of Earth creates global wind and ocean circulation patterns.\n\n```{python}\n#| label: fig-circulation\n#| fig-cap: \"Global atmospheric circulation cells\"\n#| code-fold: true\n\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\nimport numpy as np\n\nfig, ax = plt.subplots(figsize=(14, 8))\nax.set_xlim(-180, 180)\nax.set_ylim(-90, 90)\n\n# Background\nax.set_facecolor('#1E90FF')\n\n# Continents (simplified)\nax.add_patch(mpatches.Rectangle((-130, 15), 60, 60, facecolor='#228B22', alpha=0.7))  # North America\nax.add_patch(mpatches.Rectangle((-80, -60), 40, 70, facecolor='#228B22', alpha=0.7))   # South America\nax.add_patch(mpatches.Rectangle((-20, -35), 60, 80, facecolor='#228B22', alpha=0.7))   # Africa\nax.add_patch(mpatches.Rectangle((40, 10), 100, 60, facecolor='#228B22', alpha=0.7))    # Asia\nax.add_patch(mpatches.Rectangle((110, -45), 50, 35, facecolor='#228B22', alpha=0.7))   # Australia\n\n# Circulation cells\ncells = [\n    (0, 30, 'Hadley Cell', '#ff6b6b'),\n    (30, 60, 'Ferrel Cell', '#4ecdc4'),\n    (60, 90, 'Polar Cell', '#45b7d1'),\n    (0, -30, 'Hadley Cell', '#ff6b6b'),\n    (-30, -60, 'Ferrel Cell', '#4ecdc4'),\n    (-60, -90, 'Polar Cell', '#45b7d1')\n]\n\nfor y1, y2, name, color in cells:\n    # Draw cell\n    y_mid = (y1 + y2) / 2\n    for x in [-120, 0, 120]:\n        # Rising air\n        if 'Hadley' in name:\n            ax.annotate('', xy=(x-20, max(y1, y2)), xytext=(x-20, min(y1, y2)),\n                       arrowprops=dict(arrowstyle='->', color=color, lw=2))\n            ax.annotate('', xy=(x+20, min(y1, y2)), xytext=(x+20, max(y1, y2)),\n                       arrowprops=dict(arrowstyle='->', color=color, lw=2))\n        \n    ax.text(0, y_mid, name, ha='center', va='center', fontsize=10, \n            fontweight='bold', color='white',\n            bbox=dict(boxstyle='round', facecolor=color, alpha=0.8))\n\n# Wind belts\nwinds = [\n    (5, 'Trade Winds (NE)', '←'),\n    (-5, 'Trade Winds (SE)', '←'),\n    (45, 'Westerlies', '→'),\n    (-45, 'Westerlies', '→'),\n    (75, 'Polar Easterlies', '←'),\n    (-75, 'Polar Easterlies', '←')\n]\n\nfor lat, name, direction in winds:\n    ax.text(160, lat, f'{direction} {name}', fontsize=9, va='center', color='yellow')\n\n# Latitude labels\nfor lat in [-60, -30, 0, 30, 60]:\n    ax.axhline(y=lat, color='white', linestyle='--', alpha=0.3)\n    ax.text(-175, lat, f'{abs(lat)}°{\"N\" if lat > 0 else \"S\" if lat < 0 else \"\"}', \n            fontsize=9, color='white', va='center')\n\nax.text(0, 0, 'EQUATOR', ha='center', fontsize=10, color='white', fontweight='bold')\n\nax.set_xlabel('Longitude', fontsize=12)\nax.set_ylabel('Latitude', fontsize=12)\nax.set_title('Global Atmospheric Circulation', fontsize=14, fontweight='bold')\n\nplt.tight_layout()\nplt.show()\n```\n\n## Ocean Currents\n\nOcean currents redistribute heat around the globe, moderating climate.\n\n```{python}\n#| label: fig-thermohaline\n#| fig-cap: \"The global thermohaline circulation (ocean conveyor belt)\"\n#| code-fold: true\n\nimport plotly.graph_objects as go\n\nfig = go.Figure()\n\n# Warm surface currents (red)\nwarm_lats = [0, 20, 40, 55, 60, 55, 40, 30, 0, -30, -50, -60, -50, -30, 0]\nwarm_lons = [-80, -60, -40, -20, 0, 20, 40, 60, 80, 100, 120, 150, 180, -150, -120]\n\nfig.add_trace(go.Scattergeo(\n    lat=warm_lats,\n    lon=warm_lons,\n    mode='lines',\n    line=dict(width=4, color='red'),\n    name='Warm Surface Current'\n))\n\n# Cold deep currents (blue)\ncold_lats = [60, 40, 20, 0, -20, -40, -60, -50, -30, 0, 20, 40]\ncold_lons = [0, -20, -40, -60, -80, -100, -120, -150, 180, 150, 120, 90]\n\nfig.add_trace(go.Scattergeo(\n    lat=cold_lats,\n    lon=cold_lons,\n    mode='lines',\n    line=dict(width=4, color='blue'),\n    name='Cold Deep Current'\n))\n\n# Sinking regions\nfig.add_trace(go.Scattergeo(\n    lat=[65, -65],\n    lon=[-30, 0],\n    mode='markers+text',\n    marker=dict(size=15, color='darkblue', symbol='arrow-down'),\n    text=['North Atlantic\\nDeep Water', 'Antarctic\\nBottom Water'],\n    textposition='bottom center',\n    name='Sinking Zones'\n))\n\nfig.update_geos(\n    projection_type='natural earth',\n    showland=True, landcolor='lightgray',\n    showocean=True, oceancolor='lightblue'\n)\n\nfig.update_layout(\n    title='Global Thermohaline Circulation',\n    height=500\n)\nfig.show()\n```\n\n## Check Your Understanding\n\n::: {.callout-note}\n## Questions\n1. Why doesn't all of the Sun's energy reach Earth's surface?\n2. Explain how the greenhouse effect keeps Earth warm enough for life.\n3. What causes global wind patterns like the trade winds and westerlies?\n4. How do ocean currents affect climate in coastal regions?\n:::","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"toc-depth":3,"highlight-style":"github","output-file":"03-energy-flow-climate.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.553","theme":{"light":"cosmo","dark":"darkly"},"code-copy":true},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}